<!-- PAGE 1: BET DU JOUR -->
<div id="page-bet" class="page">
        <h1>BET DU JOUR</h1>
        <p class="subtitle">Les bet avec la meilleur probabilit√© de r√©ussite aujourd'hui. Nous affichons tous les bet avec minimum de 70% de chance de gagner selon notre IA.</p>

        {% assign bet_cards = section.blocks | where: 'type', 'bet_card' %}
        {% if bet_cards.size > 0 %}
          {% assign visible_bets = 0 %}
          <div class="cards-grid">
          {% for block in bet_cards %}
            {% if block.settings.show_card %}
              {% comment %} Limiter √† 1 bet si free trial {% endcomment %}
              {% if access_level == 'free_trial' and visible_bets >= 1 %}
                {% comment %} Cacher les bets suivants {% endcomment %}
              {% else %}
                {% assign visible_bets = visible_bets | plus: 1 %}
              <div class="card-wrapper">

              <div class="bet-card" style="{% if block.settings.send_to_history == true %}display:none{% endif %}" 
                   {{ block.shopify_attributes }}
                   data-block-type="bet_card"
                   data-block-id="{{ block.id }}"
                   data-sport-type="{{ block.settings.sport_type | default: 'nhl' }}"
                   data-ai-data-count="{{ block.settings.ai_data_count | default: 2843 }}"
                   data-win-percentage="{{ block.settings.win_percentage | default: 92 }}"
                   data-bet-type="{{ block.settings.bet_type | default: 'moneyline' }}"
                   data-team1-name="{{ block.settings.team1_name }}"
                   data-team1-logo="{{ block.settings.team1_logo | image_url: width: 200 }}"
                   data-team2-name="{{ block.settings.team2_name }}"
                   data-team2-logo="{{ block.settings.team2_logo | image_url: width: 200 }}"
                   data-match-time="{{ block.settings.match_time }}"
                   data-match-date="{{ block.settings.match_date }}"
                   data-multiplier="{{ block.settings.multiplier }}"
                   data-bet-units="{{ block.settings.bet_units }}"
                   data-odds="{{ block.settings.odds }}"
                   data-best-bookmaker="{{ block.settings.best_bookmaker }}"
                   data-best-odds="{{ block.settings.best_odds }}"
                   data-result="{{ block.settings.result | default: 'pending' }}"
                   data-send-to-history="{{ block.settings.send_to_history }}"
                   data-spread-value="{{ block.settings.spread_value }}"
                   data-spread-team="{{ block.settings.spread_team }}"
                   data-over-under-type="{{ block.settings.over_under_type }}"
                   data-over-under-value="{{ block.settings.over_under_value }}"
                   data-over-under-stat-type="{{ block.settings.over_under_stat_type }}"
                   data-over-under-text-custom="{{ block.settings.over_under_text_custom }}"
                   data-moneyline-team="{{ block.settings.moneyline_team | default: 'team2' }}"
              >
                 <!-- AI Analysis Header - Nouveau Layout -->
             <div class="confidence-badge" style="display: flex; align-items: center; justify-content: flex-start; gap: 0.5rem; background: rgba(0, 0, 0, 0.6); margin-top: 0.75rem; margin-bottom: 0.125rem;">
                   <!-- Gauche: Ic√¥ne IA + Pourcentage -->
                   <div style="display: flex; align-items: center; gap: 1rem;">
                     <!-- Ic√¥ne IA atomique (50px) -->
                     <div style="position: relative; width: 50px; height: 50px; flex-shrink: 0;">
                       <svg width="50" height="50" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                         <defs>
                           <filter id="softGlowBetHeader{{ forloop.index }}" x="-50%" y="-50%" width="200%" height="200%">
                             <feGaussianBlur stdDeviation="1.2" result="b"/>
                             <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
                           </filter>
                           <path id="orbit0BetHeader{{ forloop.index }}" d="M100 64a86 36 0 1 1 0 72a86 36 0 1 1 0-72" pathLength="1000"/>
                           <path id="orbit1BetHeader{{ forloop.index }}" d="M100 64a86 36 0 1 1 0 72a86 36 0 1 1 0-72" transform="rotate(55 100 100)" pathLength="1000"/>
                           <path id="orbit2BetHeader{{ forloop.index }}" d="M100 64a86 36 0 1 1 0 72a86 36 0 1 1 0-72" transform="rotate(-55 100 100)" pathLength="1000"/>
                         </defs>
                         <g stroke="#68859e" stroke-width="2" fill="none">
                           <use href="#orbit0BetHeader{{ forloop.index }}"/><use href="#orbit1BetHeader{{ forloop.index }}"/><use href="#orbit2BetHeader{{ forloop.index }}"/>
                         </g>
                         <g stroke-linecap="round" filter="url(#softGlowBetHeader{{ forloop.index }})">
                           <use href="#orbit0BetHeader{{ forloop.index }}" stroke="#ffffff" stroke-width="2" fill="none" stroke-dasharray="120 880" stroke-linecap="butt" vector-effect="non-scaling-stroke" stroke-opacity="0.95">
                             <animate attributeName="stroke-dashoffset" values="0;-1000" dur="6s" repeatCount="indefinite" begin="0s"/>
                           </use>
                           <use href="#orbit1BetHeader{{ forloop.index }}" stroke="#ffffff" stroke-width="2" fill="none" stroke-dasharray="120 880" stroke-linecap="butt" vector-effect="non-scaling-stroke" stroke-opacity="0.95">
                             <animate attributeName="stroke-dashoffset" values="500;-500" dur="6s" repeatCount="indefinite" begin="0s"/>
                           </use>
                           <use href="#orbit2BetHeader{{ forloop.index }}" stroke="#ffffff" stroke-width="2" fill="none" stroke-dasharray="120 880" stroke-linecap="butt" vector-effect="non-scaling-stroke" stroke-opacity="0.95">
                             <animate attributeName="stroke-dashoffset" values="750;-250" dur="6s" repeatCount="indefinite" begin="0s"/>
                           </use>
                         </g>
                         <text x="100" y="100" text-anchor="middle" dominant-baseline="middle" fill="#ffffff" font-weight="700" font-size="54">IA</text>
                       </svg>
                     </div>
                     
                     <!-- Pourcentage -->
                <span style="font-family: 'outfit', sans-serif; font-weight: 300; font-size: 1.80rem; color: #ffffff; line-height: 1;">{{ block.settings.win_percentage | default: 92 }}%</span>
                   </div>
                   
                   <!-- Centre: Texte confiance ia -->
                   <span style="font-family: 'fustat', sans-serif; font-weight: 400; font-size: 1.25rem; color: rgba(255, 255, 255, 0.7); line-height: 1;  margin-left: 0.5rem;">Confiance ia pour ce bet</span>
                   
                   <!-- Droite: Bouton VOIR ANALYSE IA avec coins arrondis (8px) -->
                      <button 
                      style="padding: 0.5rem 1rem; background: rgba(255, 255, 255, 0.1); color: rgba(255, 255, 255, 0.7); border: 1px solid rgba(255, 255, 255, 0.15); border-radius: 0.5rem; font-family: 'Outfit', sans-serif; font-weight: 300; font-size: 0.75rem; cursor: pointer; transition: all 0.2s; line-height: 1.2; white-space: nowrap; margin-left: auto;"
                     onclick="openAnalysisDialog(this)"
                     data-win-percentage="{{ block.settings.win_percentage | default: 92 }}"
                     data-ai-data-count="{{ block.settings.ai_data_count | default: 2843 }}"
                     data-sport-type="{{ block.settings.sport_type | default: 'nhl' }}"
                     data-team1="{{ block.settings.team1_name | default: '√âQUIPE DOMICILE' }}"
                     data-team2="{{ block.settings.team2_name | default: '√âQUIPE EXT√âRIEUR' }}"
                     data-auto-increment="{{ block.settings.auto_increment_enabled }}"
                     data-increment-interval="{{ block.settings.auto_increment_interval | default: 5 }}"
                     data-increment-amount="{{ block.settings.auto_increment_amount | default: 5 }}"
                   >
                     VOIR<br>ANALYSE<br>IA
                   </button>
                 </div>

                <div class="bet-card-content">
                  <button class="multiplier-button">x{{ block.settings.multiplier | default: '1.95' }}</button>
                  <div class="match-info-new">
                    {% assign bet_type = block.settings.bet_type | default: 'moneyline' %}
                    
                    {% if bet_type == 'moneyline' %}
                      <!-- MONEYLINE -->
                      {% assign moneyline_team = block.settings.moneyline_team | default: 'team2' %}
                      <div class="match-info-header">MONEYLINE</div>
                      <div class="match-info-content">
                        <div class="team-side {% if moneyline_team == 'team1' %}selected{% endif %}">
                          {% if block.settings.team1_logo %}
                            <img src="{{ block.settings.team1_logo | image_url: width: 200 }}" alt="{{ block.settings.team1_name }}" class="team-logo">
                          {% endif %}
                          <div class="team-name-new">{{ block.settings.team1_name | default: 'ST. LOUIS' }}</div>
                          {% if moneyline_team == 'team1' %}
                            <div class="team-bet-type">VICTOIRE</div>
                          {% endif %}
                        </div>

                        <div class="match-center">
                          <div class="match-time-new">{{ block.settings.match_time | default: '7:00 PM' }}</div>
                          <div class="match-vs-new">VS</div>
                        </div>

                        <div class="team-side {% if moneyline_team == 'team2' %}selected{% endif %}">
                          {% if block.settings.team2_logo %}
                            <img src="{{ block.settings.team2_logo | image_url: width: 200 }}" alt="{{ block.settings.team2_name }}" class="team-logo">
                          {% endif %}
                          <div class="team-name-new">{{ block.settings.team2_name | default: 'PITTSBURGH' }}</div>
                          {% if moneyline_team == 'team2' %}
                            <div class="team-bet-type">VICTOIRE</div>
                          {% endif %}
                        </div>
                      </div>
                    
                    {% elsif bet_type == 'spread' %}
                      <!-- SPREAD -->
                      <div class="match-info-header">SPREAD</div>
                      <div class="match-info-content">
                        <div class="team-side {% if block.settings.spread_team == 'team1' %}selected{% endif %}">
                          {% if block.settings.team1_logo %}
                            <img src="{{ block.settings.team1_logo | image_url: width: 200 }}" alt="{{ block.settings.team1_name }}" class="team-logo">
                          {% endif %}
                          <div class="team-name-new">{{ block.settings.team1_name | default: 'ST. LOUIS' }}</div>
                          {% if block.settings.spread_team == 'team1' %}
                            <div class="team-bet-type">{{ block.settings.spread_value | default: '-3.5' }}</div>
                          {% endif %}
                        </div>

                        <div class="match-center">
                          <div class="match-time-new">{{ block.settings.match_time | default: '7:00 PM' }}</div>
                          <div class="match-vs-new">VS</div>
                        </div>

                        <div class="team-side {% if block.settings.spread_team == 'team2' %}selected{% endif %}">
                          {% if block.settings.team2_logo %}
                            <img src="{{ block.settings.team2_logo | image_url: width: 200 }}" alt="{{ block.settings.team2_name }}" class="team-logo">
                          {% endif %}
                          <div class="team-name-new">{{ block.settings.team2_name | default: 'PITTSBURGH' }}</div>
                          {% if block.settings.spread_team == 'team2' %}
                            <div class="team-bet-type">{{ block.settings.spread_value | default: '-3.5' }}</div>
                          {% endif %}
                        </div>
                      </div>
                    
                     {% elsif bet_type == 'over_under' %}
                      <!-- OVER/UNDER -->
                      {% assign custom_text = block.settings.over_under_text_custom | default: '' %}
                      {% if custom_text != blank %}
                        <div class="match-info-header">{{ custom_text | upcase }}</div>
                      {% else %}
                        <div class="match-info-header">{{ block.settings.over_under_type | default: 'OVER' | upcase }}</div>
                      {% endif %}
                      <div class="match-info-content">
                        <div class="team-side">
                          {% if block.settings.team1_logo %}
                            <img src="{{ block.settings.team1_logo | image_url: width: 200 }}" alt="{{ block.settings.team1_name }}" class="team-logo">
                          {% endif %}
                          <div class="team-name-new">{{ block.settings.team1_name | default: 'ST. LOUIS' }}</div>
                        </div>

                        <div class="match-center">
                          <div class="match-time-new">{{ block.settings.match_time | default: '7:00 PM' }}</div>
                          <div class="match-vs-new">VS</div>
                          <div class="over-under-display">
                            {% if custom_text != blank %}
                              <div class="over-under-type">{{ custom_text | upcase }}</div>
                            {% else %}
                              <div class="over-under-type">{{ block.settings.over_under_type | default: 'OVER' | upcase }}</div>
                            {% endif %}
                            <div class="over-under-value">{{ block.settings.over_under_value | default: '225.5' }}</div>
                            {% if block.settings.over_under_stat_type != blank %}
                              <div class="over-under-stat">{{ block.settings.over_under_stat_type }}</div>
                            {% endif %}
                          </div>
                        </div>

                        <div class="team-side">
                          {% if block.settings.team2_logo %}
                            <img src="{{ block.settings.team2_logo | image_url: width: 200 }}" alt="{{ block.settings.team2_name }}" class="team-logo">
                          {% endif %}
                          <div class="team-name-new">{{ block.settings.team2_name | default: 'PITTSBURGH' }}</div>
                        </div>
                      </div>
                    {% endif %}
                  </div>

                  <button class="units-button">{{ block.settings.bet_units | default: '1' }} UNITS</button>

                  <div class="gain-section">
                    <div class="bet-modify-horizontal">
                      <div class="bet-info">
                        <span>VOTRE MISE - <span class="bet-amount-value-small">$100</span></span>
                      </div>
                      <button class="modify-btn" onclick="openBetDialog(this)" data-multiplier="{{ block.settings.multiplier | default: '1.95' }}">MODIFIER</button>
                    </div>
                    <div class="cashout-full-width">
                      <div class="cashout-label">CASHOUT</div>
                      <div class="cashout-amount">${{ 100 | times: block.settings.multiplier | default: 1.95 | round: 2 }}</div>
                      <div class="cashout-profit">+${{ 100 | times: block.settings.multiplier | default: 1.95 | minus: 100 | round: 2 }} b√©n√©fice</div>
                    </div>
                  </div>
                </div>
              </div>
              </div> <!-- card-wrapper -->
              {% endif %}
            {% endif %}
          {% endfor %}
          
{% comment %} Message de restriction pour free trial {% endcomment %}
{% if access_level == 'free_trial' and bet_cards.size > 1 %}
  <div class="card text-center" style="padding: 2.5rem; background: rgba(255, 255, 255, 0.03); border: 2px solid rgba(255, 255, 255, 0.1);">
    <div style="font-size: 2.5rem; margin-bottom: 1rem;">üîí</div>
    <h3 style="color: rgba(255, 255, 255, 0.95); font-size: 1.6rem; margin-bottom: 0.8rem; font-weight: 600;">D√©bloquer tous les bets</h3>
    <p style="color: rgba(255, 255, 255, 0.7); font-size: 1.05rem; margin-bottom: 1.5rem; line-height: 1.5;">
      Pour voir tous les bets, un plan payant est requis. Une fois votre essai gratuit termin√©, vous y aurez acc√®s.
    </p>
    <a href="https://winabet.ai" style="display: inline-block; background: rgba(255, 255, 255, 0.1); color: #ffffff; padding: 0.9rem 2rem; border-radius: 0.5rem; text-decoration: none; font-size: 1rem; font-weight: 600; border: 1px solid rgba(255, 255, 255, 0.2); transition: all 0.2s; margin-bottom: 1.2rem;">
      Passer √† un Abonnement
    </a>
    <p style="color: rgba(255, 255, 255, 0.5); font-size: 0.9rem; margin-top: 1.2rem;">
      Besoin d'assistance ? Contactez-nous au <a href="tel:4382234581" style="color: rgba(255, 255, 255, 0.8); text-decoration: underline;">438-223-4581</a> ou <a href="mailto:info@winabet.ai" style="color: rgba(255, 255, 255, 0.8); text-decoration: underline;">info@winabet.ai</a>
    </p>
  </div>
{% endif %}
          </div> <!-- cards-grid -->
        {% else %}
          <div class="card text-center" style="padding: 2rem;">
            <p style="color: rgba(255, 255, 255, 0.6);">
              Aucune carte de pari ajout√©e. Utilisez l'√©diteur Shopify pour ajouter vos premi√®res recommandations de type "üéØ Carte Bet du Jour".
            </p>
          </div>
        {% endif %}
      </div>
</div> <!-- page-bet -->